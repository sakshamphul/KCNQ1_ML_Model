Combine(
  Define(AllMutationData=Mapped(file=./a1q1.model_data.csv,key=MutationId,delimiter=",")),
  Define(IsRealMutation=NotEqual(MaxIndex(NativeAADescriptor(AAType)),MaxIndex(MutantAADescriptor(AAType)))),
  Define(Ikspeak=Partial(AllMutationData,indices( 0))), 
  Define(Vhalf=Partial(AllMutationData,indices( 1))),
  Define(tau_=Partial(AllMutationData,indices( 2))),
  Define(tau_de=Partial(AllMutationData,indices( 3))),
  Define(Vhalfact=Add(Multiply(lhs=Less(lhs=Ikspeak,rhs=Constant(0.1701)),Constant(10000)),Multiply(lhs=Greater(lhs=Ikspeak,rhs=Constant(0.1701)),Vhalf))),
  Define(tau_act=Add(Multiply(lhs=Less(lhs=Ikspeak,rhs=Constant(0.1701)),Constant(10000)),Multiply(lhs=Greater(lhs=Ikspeak,rhs=Constant(0.1701)),tau_))),
  Define(tau_deact=Add(Multiply(lhs=Less(lhs=Ikspeak,rhs=Constant(0.1701)),Constant(10000)),Multiply(lhs=Greater(lhs=Ikspeak,rhs=Constant(0.1701)),tau_de))),
  Define(too_low_ik=    Less(lhs=Ikspeak,rhs=Constant(0.551))), 
  Define(too_high_ik=  Greater(lhs=Ikspeak,rhs=Constant(1.151))),
  Define(vhalf_too_high=Greater(lhs=Vhalfact,rhs=Constant(1.301))),
  Define(vhalf_too_low= Less(lhs=Vhalfact,rhs=Constant(0.801))),
  Define(too_slow_act=  Greater(lhs=tau_act,rhs=Constant(1.701))),
  Define(too_fast_act= Less(lhs=tau_act,rhs=Constant(0.701))),
  Define(too_fast_inact=Less(lhs=tau_deact,rhs=Constant(0.751))),
  Define(too_slow_inact=Greater(lhs=tau_deact,rhs=Constant(1.251))),
  Define(ik_dys=Add(too_low_ik,too_high_ik)),
  Define(vhalf_dys=Add(vhalf_too_low,vhalf_too_high)),
  Define(act_dys=Add(too_fast_act,too_slow_act)),
  Define(inact_dys=Add(too_fast_inact,too_slow_inact)),  
  Define(vhalf_dys_NotNaN=DefineNaN(vhalf_dys,replacement=Constant(1))),
  Define(act_total=Add(ik_dys,vhalf_dys_NotNaN,inact_dys)),
  Define(deact_total=Add(ik_dys,vhalf_dys_NotNaN,act_dys)),
  Define(act_dys_NotNaN=DefineNaN(act_dys,replacement=Greater(lhs=act_total,rhs=Constant(1.5)))), 
  Define(deact_dys_NotNaN=DefineNaN(inact_dys,replacement=Greater(lhs=deact_total,rhs=Constant(1.5)))),
ik_dys,
vhalf_dys,
act_dys,
inact_dys
)
